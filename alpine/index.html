<html lang="en" xmlns:x-on="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alpine.js Crash Course</title>
  <link rel="stylesheet" href="styles.css">

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="index.js"></script>
</head>
<body>

<!-- <div x-data="{ count: 0, name: 'Mario' }">
  <h1>Hi, <span x-text="name"></span></h1>
  <p>The current value of the count is: <span x-text="count"></span></p>
  <button x-on:click="count++">Increase count by 1</button>
</div> -->

<div x-data="state">
  <label for="start">Start date:</label>
  <input type="date" id="start" name="trip-start"
         x-model="startDate"
         min="2025-01-01" max="2027-12-31">

  <label for="end">Start date:</label>
  <input type="date" id="end" name="trip-start"
         x-model="endDate"
         min="2025-01-01" max="2027-12-31">
</div>

<div style="display: flex; gap: 20px;">
    <div style="width: 45%;">
        <canvas id="incomeChart"></canvas>
    </div>
    <div style="width: 45%;">
        <canvas id="expenseChart"></canvas>
    </div>
</div>

<script>
    function createChart(elementId, title, labels, data) {
        const ctx = document.getElementById(elementId);
        if (ctx) {
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(153, 102, 255, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: title,
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
        }
    }

    document.addEventListener('alpine:init', () => {
        Alpine.effect(() => {
            const state = Alpine.store('state');
            if (state) {
                createChart(
                    'incomeChart', 
                    `Income: $${state.incomeData.sum.toFixed(2)}`, 
                    state.incomeData.labels, 
                    state.incomeData.data
                );
                
                createChart(
                    'expenseChart', 
                    `Expense: $${state.expenseData.sum.toFixed(2)}`, 
                    state.expenseData.labels, 
                    state.expenseData.data
                );
            }
        });
    });
</script>
</body>
</html>
